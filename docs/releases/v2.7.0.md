# Release v2.7.0

**Release Date:** October 26, 2025

## 🌐 Accept-Language Auto-Detection

The major feature of this release is automatic browser language detection from `Accept-Language` headers.

### What's New

#### Automatic Language Detection

i18nexus now automatically detects the user's preferred language from their browser settings via the `Accept-Language` HTTP header.

```tsx
import { createServerI18n } from "i18nexus/server";

export default async function Page() {
  const { t, language } = await createServerI18n({
    availableLanguages: ["en", "ko", "ja", "zh"],
    defaultLanguage: "en",
  });

  // Automatically detects from:
  // 1. Cookie (if user selected)
  // 2. Accept-Language: ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7
  // 3. Default language (fallback)

  return (
    <h1>
      {t("Welcome")} - {language}
    </h1>
  );
}
```

#### Quality Value Support

Properly parses and respects quality values (q-factors) from the Accept-Language header:

```
Accept-Language: en;q=0.5,ko;q=0.9,ja;q=0.7
// Will select "ko" (highest quality)
```

#### Region Code Support

Handles language region codes gracefully:

```
Accept-Language: en-US,en;q=0.9
// Matches to "en" if "en-US" not in availableLanguages
```

### New Functions

#### `parseAcceptLanguage()`

```typescript
import { parseAcceptLanguage } from "i18nexus/server";

const language = parseAcceptLanguage("ko-KR,ko;q=0.9,en-US;q=0.8", [
  "en",
  "ko",
  "ja",
]);
// Returns: "ko"
```

#### Updated `getServerLanguage()`

```typescript
import { getServerLanguage } from "i18nexus/server";

const language = getServerLanguage(headers, {
  availableLanguages: ["en", "ko", "ja"],
  defaultLanguage: "en",
});
```

#### Updated `createServerI18n()`

```typescript
const { t, language } = await createServerI18n({
  availableLanguages: ["en", "ko", "ja", "zh"],
  defaultLanguage: "en",
});
```

### Documentation

- 📖 New: `docs/guides/accept-language.md` - Complete guide with examples
- 📝 Updated: README with Accept-Language features
- 📋 Updated: CHANGELOG with detailed changes

### Testing

- ✅ 20+ test cases for Accept-Language parsing
- ✅ Quality value sorting tests
- ✅ Region code matching tests
- ✅ Fallback chain tests

### Breaking Changes

**None!** Accept-Language detection is opt-in via the `availableLanguages` parameter.

### Migration from v2.6.0

No changes required! Simply add `availableLanguages` to enable auto-detection:

```tsx
// Before (still works)
const { language } = await createServerI18n({
  defaultLanguage: "en",
});

// After (with auto-detection)
const { language } = await createServerI18n({
  availableLanguages: ["en", "ko", "ja"], // Add this
  defaultLanguage: "en",
});
```

### Performance

- Zero overhead when `availableLanguages` not provided
- Optimized language matching algorithm
- ~2KB gzipped bundle size increase

---

## Full Changelog

See [CHANGELOG.md](../CHANGELOG.md) for complete details.

## Links

- 📦 [npm Package](https://www.npmjs.com/package/i18nexus)
- 🐙 [GitHub](https://github.com/manNomi/i18nexus)
- 📖 [Documentation](../../README.md)
